<!DOCTYPE html>
<html>

<head>
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>

    <script>
        window.onerror = function (message, source, lineno, colno, error) {
            document.getElementById("theDebug").innerHTML += `<br><span style="color: red">${message} at ${source}:${lineno}:${colno}</span>`;
            alert(`An error occurred: ${message} at ${source}:${lineno}:${colno}`);
            return false;  // Let the browser console still show the error if available
        };

        window.addEventListener('unhandledrejection', function (event) {
            document.getElementById("theDebug").innerHTML += `<br><span style="color: red">${event.reason}</span>`;
            alert(`An unhandled promise rejection occurred: ${event.reason}`);
        });

        var debugDiv = document.getElementById('theDebug');

        function scrollToBottom() {
            var debugDiv = document.getElementById('theDebug');
            debugDiv.scrollTop = debugDiv.scrollHeight - debugDiv.clientHeight;
        }

        // Function to check if scrolled to the bottom
        function isScrolledToBottom() {
            // Check if the scroll position is at the bottom
            return debugDiv.scrollTop + debugDiv.clientHeight >= debugDiv.scrollHeight;
        }

        function dothiS() {
            var debugDiv = document.getElementById('theDebug');
            debugDiv.scrollTop = debugDiv.scrollHeight - debugDiv.clientHeight;
            return;
        }

        let line = -1;
        console.log("%cConsole moved inside the app.", "color: red; font-family:sans-serif; font-size: 20px");

        const originalConsoleLog = console.log;

        // Override the console.log function
        console.log = function (...args) {
            line = line + 1;
            document.getElementById("theDebug").innerHTML += `<br>[${line}]: ${args.join(' ')}`;
            dothiS();
        };

        // Function to get OneSignal Player ID and log it
        async function getPlayerId(OneSignal) {
            try {
                const userId = await OneSignal.getUserId();
                if (userId) {
                    const localStorageKey = `${localStorage.getItem("t50-username")}-playerId`;
                    localStorage.setItem(localStorageKey, userId);
                    console.log(`Player ID saved as ${localStorageKey}: ${userId}`);
                } else {
                    console.error('Failed to retrieve Player ID.');
                }
            } catch (error) {
                console.error('Error retrieving Player ID:', error);
            }
        }

        window.OneSignalDeferred = window.OneSignalDeferred || [];
        OneSignalDeferred.push(async function (OneSignal) {
            await OneSignal.init({
                appId: "67bee91b-61fc-42ce-89ae-2f091cda5d24",
                safari_web_id: "web.onesignal.auto.0860f031-816f-4b4e-9724-08fcd0b320db",
                notifyButton: {
                    enable: true,
                },
            });

            // Call the function to get and log the Player ID
            getPlayerId(OneSignal);
        });
    </script>
</head>

<body>
    Setting up florida now.
    <br>
    <div style="width: 500px;
        aspect-ratio: 1.6 / 1;
        object-fit: cover;
        border-radius: 0.5rem;
        border-bottom-left-radius: 0.25rem;
        border-bottom-right-radius: 0.25rem;background-color: #000000;color:lime;height: 211px;padding: 20px; max-height: 211px; overflow: auto;"
        id="theDebug">Terminal Launched
    </div>
</body>

</html>
